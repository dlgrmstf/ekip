@model EkipProjesi.Core.Hastalar.IHastalar
@{
    ViewBag.Title = "Vaka Detay";
    Layout = "~/Views/Shared/_Layout.cshtml";
    #region Const
    List<EkipProjesi.Core.Formlar.AnketDTO> formlarim = (List<EkipProjesi.Core.Formlar.AnketDTO>)ViewBag.Formlarim;
    List<EkipProjesi.Core.Hastalar.IHastaYakinBilgileri> bilgiler = (List<EkipProjesi.Core.Hastalar.IHastaYakinBilgileri>)ViewBag.YakinBilgileri;
    List<EkipProjesi.Core.Hastalar.IHastaIlkKayitBilgileri> ilkKayitBilgileri = (List<EkipProjesi.Core.Hastalar.IHastaIlkKayitBilgileri>)ViewBag.IlkKayitBilgileri;
    List<EkipProjesi.Core.Hastalar.IHastaIzlemBilgileri> izlemBilgileri = (List<EkipProjesi.Core.Hastalar.IHastaIzlemBilgileri>)ViewBag.IzlemBilgileri;
    List<EkipProjesi.Core.Hastalar.IHastaTimeline> timelineBilgileri = (List<EkipProjesi.Core.Hastalar.IHastaTimeline>)ViewBag.TimelineBilgileri;
    List<EkipProjesi.Core.Randevu.IRandevuBilgileri> randevular = (List<EkipProjesi.Core.Randevu.IRandevuBilgileri>)ViewBag.RandevuBilgileri;
    List<EkipProjesi.Core.Hastalar.IHastaNotlari> notlar = (List<EkipProjesi.Core.Hastalar.IHastaNotlari>)ViewBag.HastaNotlari;
    #endregion
}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
@*<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>*@
<link rel="stylesheet" href="~/dist/vendors/datatable/css/dataTables.bootstrap4.min.css" />
<link rel="stylesheet" href="~/dist/vendors/datatable/buttons/css/buttons.bootstrap4.min.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="~/js/input-mask.min.js"></script>

<div class="row">
    <div class="col-12  align-self-center">
        <div class="sub-header mt-3 py-3 align-self-center d-sm-flex w-100 rounded">
            <div class="w-sm-100 mr-auto"><h4 class="mb-0">Vaka Detay Ekranı</h4> <a href="@Url.Action("Index", "VakaTakip")"><p>Vaka Takip Modülü</p></a></div>
            <ol class="breadcrumb bg-transparent align-self-center m-0 p-0">
                <li class="breadcrumb-item"><a href="#">Vaka Detay Ekranı</a></li>
                <li class="breadcrumb-item active">Anasayfa</li>
            </ol>
        </div>
    </div>
</div>

<div id="YakinBilgileriModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body" style="width:500px; height:350px;">
                <form class="form-horizontal">
                    <input type="hidden" id="ID" value="0" />
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <label>Yakın Adı</label>
                            <input type="text" id="YakinAdi" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Yakın Soyadı</label>
                            <input type="text" id="YakinSoyadi" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Yakınlık Derecesi</label>
                            <input type="text" id="YakinlikDerecesi" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Telefon</label>
                            <input type="text" id="YakinTelefon" class="form-control tel" />
                        </div>
                        <div class="form-group col-sm-12">
                            <label>Adres</label>
                            <textarea type="text" id="YakinAdres" class="form-control" cols="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="btnYakinBilgiKaydet" class="btn btn-success btn-md pull-right">Kaydet</button>
                        <button type="button" class="btn btn-default btn-md pull-right" data-dismiss="modal" id="btnClose">Kapat</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="IlkKayitBilgileriModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body" style="width:500px; height:350px;">
                <form class="form-horizontal">
                    <input type="hidden" id="ID" value="0" />
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <label>Kurum Türü</label>
                            <input type="text" id="KurumTuru" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Kaydeden Kurum</label>
                            <input type="text" id="KaydedenKurum" class="form-control" />
                        </div>
                        <div class="form-group col-sm-12">
                            <label>Vaka Bilgi Kaynağı</label>
                            <input type="text" id="VakaBilgiKaynagi" class="form-control" />
                        </div>
                        <div class="form-group col-sm-12">
                            <label>Elde Edilen Bilgiler</label>
                            <textarea type="text" id="EldeEdilenBilgiler" class="form-control" cols="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="btnIlkKayitKaydet" class="btn btn-success btn-md pull-right">Kaydet</button>
                        <button type="button" class="btn btn-default btn-md pull-right" data-dismiss="modal" id="btnClose">Kapat</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="IzlemBilgileriModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body" style="width:500px; height:500px;">
                <form class="form-horizontal">
                    <input type="hidden" id="ID" value="0" />
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <label>İzlem Başlığı</label>
                            <input type="text" id="IzlemBasligi" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>İzlem Açıklama</label>
                            <input type="text" id="IzlemAciklama" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>İzlem Yapan Kurum Türü</label>
                            <input type="text" id="IzlemYapanKurumTuru" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>İzlem Yapan Kurum</label>
                            <input type="text" id="IzlemYapanKurum" class="form-control" />
                        </div>
                        <div class="form-group col-sm-12">
                            <label>İzlem Vaka Kaynağı</label>
                            <input type="text" id="IzlemVakaKaynagi" class="form-control" />
                        </div>
                        <div class="form-group col-sm-12">
                            <label>Elde Edilen Bilgiler</label>
                            <textarea type="text" id="EldeEdilenBilgiler2" class="form-control" cols="3"></textarea>
                        </div>
                        <div class="form-group col-sm-12">
                            <label>İzlem Sonucu</label>
                            <textarea type="text" id="IzlemSonucu" class="form-control" cols="3"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="btnIzlemKaydet" class="btn btn-success btn-md pull-right">Kaydet</button>
                        <button type="button" class="btn btn-default btn-md pull-right" data-dismiss="modal" id="btnClose">Kapat</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div id="TimelineModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body" style="width:500px; height:350px;">
                <form class="form-horizontal">
                    <input type="hidden" id="ID" value="0" />
                    <div class="row">
                        <div class="form-group col-sm-6">
                            <label>Başlık</label>
                            <input type="text" id="Baslik" class="form-control" />
                        </div>
                        <div class="form-group col-sm-6">
                            <label>Tarih</label>
                            <input type="date" id="Tarih" class="form-control" />
                        </div>
                        <div class="form-group col-sm-12">
                            <label>Açıklama</label>
                            <textarea type="text" id="Aciklama" class="form-control" cols="15" style="max-height:140px"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="btnTimelineKaydet" class="btn btn-success btn-md pull-right">Kaydet</button>
                        <button type="button" class="btn btn-default btn-md pull-right" data-dismiss="modal" id="btnClose">Kapat</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12 mt-1">
        <div class="position-relative">
            <div class="position-relative px-1 py-3" style="background-color: #1e3d73">
                <div class="media d-md-flex d-block">
                    <a href="#"><img src="~/images/user.png" width="100" height="100" alt="" class="img-fluid rounded-circle" style="margin-left:10px"></a>
                    <div class="media-body z-index-1">
                        <div class="pl-4">
                            <h3 class="display-4 text text-white mb-0">@Model.HastaAdi @Model.HastaSoyadi</h3>
                            <h6 class="text text-white mb-0">TC Kimlik No: @Model.HastaTCKimlikNo</h6>
                            <h6 class="text text-white mb-0">Hasta Ekip No: @Model.HastaEkipNo</h6>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="profile-menu mt-4 theme-background border  z-index-1 p-2">
            <div class="d-sm-flex">
                <div class="align-self-center">
                    <ul class="nav nav-pills flex-column flex-sm-row" id="myTab" role="tablist">
                        @if (User.IsInRole("119"))
                        {
                            <li class="nav-item ml-0">
                                <a class="nav-link  py-2 px-3 px-lg-4  active" data-toggle="tab" href="#kisiselbilgiler"> Kişisel Bilgiler</a>
                            </li>
                        }
                        @if (User.IsInRole("120"))
                        {
                            <li class="nav-item ml-0">
                                <a class="nav-link  py-2 px-4 px-lg-4 " data-toggle="tab" href="#ilkkayitbilgileri"> İlk Kayıt Bilgileri</a>
                            </li>
                        }
                        @if (User.IsInRole("121"))
                        {
                            <li class="nav-item ml-0">
                                <a class="nav-link py-2 px-4 px-lg-4" data-toggle="tab" href="#izlembilgileri">İzlem Bilgileri </a>
                            </li>
                        }
                        @if (User.IsInRole("122"))
                        {
                            <li class="nav-item ml-0 mb-2 mb-sm-0">
                                <a class="nav-link py-2 px-4 px-lg-4" data-toggle="tab" href="#timeline"> Timeline</a>
                            </li>
                        }
                        @if (User.IsInRole("123"))
                        {
                            <li class="nav-item ml-0 mb-2 mb-sm-0">
                                <a class="nav-link py-2 px-4 px-lg-4" data-toggle="tab" href="#yonlendirmeler"> Yönlendirmeler</a>
                            </li>
                        }
                        @if (User.IsInRole("124"))
                        {
                            <li class="nav-item ml-0 mb-2 mb-sm-0">
                                <a class="nav-link py-2 px-4 px-lg-4" data-toggle="tab" href="#notlar"> Notlar</a>
                            </li>
                        }
                        @if (User.IsInRole("125"))
                        {
                            <li class="nav-item ml-0 mb-2 mb-sm-0">
                                <a class="nav-link py-2 px-4 px-lg-4" data-toggle="tab" href="#formlar"> Formlar</a>
                            </li>
                        }
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-3">
    <div class="col-xl-12">
        <div class="card">
            <div class="card-body">
                <div class="tab-content">
                    @if (User.IsInRole("119"))
                    {
                        <div class="tab-pane active" id="kisiselbilgiler" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="card-title">Kişisel Bilgiler</h6>
                                </div>
                                <div class="card-content">
                                    <div class="table-responsive">
                                        <table class="table kisisel">
                                            <tbody>
                                                <tr>
                                                    <td><b>Ad - Soyad</b></td>
                                                    <td><b>:</b></td>
                                                    <td>@Model.HastaAdi @Model.HastaSoyadi</td>

                                                    <td><b>TC Kimlik No</b></td>
                                                    <td><b>:</b></td>
                                                    <td>@Model.HastaTCKimlikNo</td>
                                                </tr>
                                                <tr>
                                                    <td><b>Doğum Tarihi</b></td>
                                                    <td><b>:</b></td>
                                                    <td>@Model.DogumTarihi.ToString("dd/MM/yyyy")</td>

                                                    <td><b>Hasta Ekip No</b></td>
                                                    <td><b>:</b></td>
                                                    <td>@Model.HastaEkipNo</td>
                                                </tr>
                                                <tr>
                                                    <td><b>Telefon</b></td>
                                                    <td><b>:</b></td>
                                                    <td>@Model.Telefon</td>

                                                    @if (Model.Cinsiyet != null)
                                                    {
                                                        <td><b>Cinsiyet</b></td>
                                                        <td><b>:</b></td>
                                                        <td>@Model.Cinsiyet</td>
                                                    }
                                                    else
                                                    {
                                                        <td></td>
                                                        <td></td>
                                                        <td></td>
                                                    }
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <br /><br />
                            <div class="card">
                                <div class="card-header">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <h6 class="card-title">Yakın Bilgileri</h6>
                                        </div>
                                        @if (User.IsInRole("71"))
                                        {
                                            <div class="col-md-2">
                                                <button class="btn btn-outline-info" id="btnShow"><i class="icon-plus"></i> &nbsp;Ekle</button>
                                            </div>
                                        }
                                    </div>
                                </div>
                                <div class="card-content">
                                    <div class="table-responsive">
                                        <table class="table layout-primary yakinbilgileri">
                                            <thead>
                                                <tr>
                                                    <th scope="col"></th>
                                                    <th scope="col">Ad - Soyad</th>
                                                    <th scope="col">Yakınlık Derecesi</th>
                                                    <th scope="col">Telefon</th>
                                                    <th scope="col">Adres</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var b in bilgiler)
                                                {
                                                    <tr>
                                                        <td></td>
                                                        <td>@b.YakinAdi @b.YakinSoyadi</td>
                                                        <td>@b.YakinlikDerecesi</td>
                                                        <td>@b.Telefon</td>
                                                        <td>@b.Adres</td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <br /><br />
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="card-title">Beyan Bilgileri</h6>
                                </div>
                                <div class="card-content">
                                    <div class="table-responsive">
                                        <table class="table layout-primary beyanbilgileri">
                                            <thead>
                                                <tr>
                                                    <th scope="col">#</th>
                                                    <th scope="col">Beyan Telefonu</th>
                                                    <th scope="col">Beyan Adresi</th>
                                                    <th scope="col">Beyan Aldığı Kurum</th>
                                                    <th scope="col">Beyan Tarihi</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <th scope="row"></th>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @if (User.IsInRole("120"))
                    {
                        <div class="tab-pane" id="ilkkayitbilgileri" role="tabpanel">
                            <div class="card">
                                <div class="card-header  justify-content-between align-items-center">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <h5 class="card-title">İlk Kayıt Bilgileri</h5>
                                        </div>
                                        @*<div class="col-md-2">
                                                <button class="btn btn-outline-info" id="btnIlkKayitEkle"><i class="icon-plus"></i> &nbsp;Ekle</button>
                                            </div>*@
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table id="example" class="display table dataTable table-striped table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>İlk Kayıt Tarihi</th>
                                                    <th>İlk Kayıt Kurum Türü</th>
                                                    <th>İlk Kaydeden Kurum</th>
                                                    <th>İlk Kayıt Vaka Bilgi Kaynağı</th>
                                                    @*<th>Detay</th>*@
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var b in ilkKayitBilgileri)
                                                {
                                                    <tr>
                                                        <td>@b.KayitTarihi.ToString("dd/MM/yyyy HH:mm")</td>
                                                        <td>@b.KurumTuru</td>
                                                        <td>@b.KaydedenKurum</td>
                                                        <td>@b.VakaBilgiKaynagi</td>
                                                        @*<td><a class="text-success edit-contact" href="@Url.Action("VakaIlkKayitDetay","KoruyucuOnleyiciHizmetler", new { id = b.ID })" name="Detay" target="_blank"><i class="icon-plus"></i></a></td>*@
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @if (User.IsInRole("121"))
                    {
                        <div class="tab-pane" id="izlembilgileri" role="tabpanel">
                            <div class="card">
                                <div class="card-header  justify-content-between align-items-center">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <h5 class="card-title">İzlem Bilgileri</h5>
                                        </div>
                                        @if (User.IsInRole("72"))
                                        {
                                            <div class="col-md-2">
                                                <button class="btn btn-outline-info" id="btnIzlemEkle"><i class="icon-plus"></i> &nbsp;Ekle</button>
                                            </div>
                                        }
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive izlembilgileri">
                                        <table id="example2" class="display table dataTable table-striped table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>İzlem Tarihi</th>
                                                    <th>İzlem Kurum Türü</th>
                                                    <th>İzlem Yapan Kurum</th>
                                                    <th>İzlem Vaka Kaynağı</th>
                                                    <th>İzlemde Elde Edilen Bilgiler</th>
                                                    <th>İzlem Sonucu</th>
                                                    @*<th>Detay</th>*@
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var b in izlemBilgileri)
                                                {
                                                    <tr>
                                                        <td>@b.IzlemTarihi.ToString("dd/MM/yyyy HH:mm")</td>
                                                        <td>@b.IzlemYapanKurumTuru</td>
                                                        <td>@b.IzlemYapanKurum</td>
                                                        <td>@b.IzlemVakaKaynagi</td>
                                                        <td>@b.EldeEdilenBilgiler</td>
                                                        <td>@b.IzlemSonucu</td>
                                                        @*<td><a class="text-success edit-contact" href="@Url.Action("VakaIzlemBilgileriDetay","KoruyucuOnleyiciHizmetler", new { id = b.ID })" name="Detay" target="_blank"><i class="icon-plus"></i></a></td>*@
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @if (User.IsInRole("122"))
                    {
                        <div class="tab-pane" id="timeline" role="tabpanel">
                            <div class="card">
                                <div class="card-header  justify-content-between align-items-center">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <h5 class="card-title">Timeline</h5>
                                        </div>
                                        @*<div class="col-md-2">
                                                <button class="btn btn-outline-info" id="btnTimelineEkle"><i class="icon-plus"></i> &nbsp;Ekle</button>
                                            </div>*@
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="col-12  mt-3">
                                        <ul class="timeline-app">
                                            @foreach (var t in izlemBilgileri)
                                            {
                                                if (t.ID % 2 == 1)
                                                {
                                                    <li class="timeline-item" style="display: none;">
                                                        <div class="timeline-dot"><i class="icon-user icons"></i></div>
                                                        <div class="time-strip">
                                                            @t.IzlemTarihi.ToString("yyyy")
                                                        </div>
                                                        <div class="card w-100 overflow-hidden">
                                                            <div class="card-block p-3">
                                                                <h3 class="card-title">@t.IzlemBasligi</h3>
                                                                <p class="card-text">
                                                                    <small>@t.IzlemTarihi.ToString("dd/MMMM/yyyy")</small>
                                                                </p>
                                                                <p>
                                                                    @t.IzlemAciklama
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </li>
                                                }
                                                else if (t.ID % 2 == 0)
                                                {
                                                    <li class="timeline-item reverse" style="display: none;">
                                                        <div class="time-strip">
                                                            @t.IzlemTarihi.ToString("yyyy")
                                                        </div>
                                                        <div class="timeline-dot bg-success"><i class="icon-compass icons"></i></div>
                                                        <div class="card w-100 overflow-hidden">
                                                            <div class="card-block p-3">
                                                                <h3 class="card-title">@t.IzlemBasligi</h3>
                                                                <p class="card-text">
                                                                    <small>@t.IzlemTarihi.ToString("dd/MMMM/yyyy")</small>
                                                                </p>
                                                                <p>
                                                                    @t.IzlemAciklama
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </li>
                                                }
                                            }
                                        </ul>
                                    </div>
                                    <div id="loadMore" style="display: flex; justify-content: center; align-items: center;">
                                        <button class="btn btn-primary" style="align-items:center">Timeline Yükle</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @if (User.IsInRole("123"))
                    {
                        <div class="tab-pane" id="yonlendirmeler" role="tabpanel">
                            <div class="card">
                                <div class="card-header  justify-content-between align-items-center">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <h3 class="card-title">Yönlendirmeler</h3>
                                        </div>
                                        @if (User.IsInRole("73"))
                                        {
                                            <div class="col-md-2">
                                                <div class="align-content-lg-end">
                                                    <div class="btn-group">
                                                        <button type="button" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Yönlendirme Ekle</button>
                                                        <div class="dropdown-menu p-0" style="">
                                                            <a class="dropdown-item" href="#" id="arindirmaYonlendir">Arındırma Tedavisi</a>
                                                            <a class="dropdown-item" href="#" id="rehabilitasyonYonlendir">Rehabilitasyon Tedavisi</a>
                                                            <a class="dropdown-item" href="#" id="yedamYonlendir">YEDAM</a>
                                                            <a class="dropdown-item" href="#" id="ilceSaglikYonlendir">İlçe Sağlık Müdürlükleri</a>
                                                            <a class="dropdown-item" href="#" id="sosyalHizmetYonlendir">Sosyal Hizmet Merkezleri</a>
                                                            <a class="dropdown-item" href="#" id="iskurYonlendir">İşkur</a>
                                                            <a class="dropdown-item" href="#" id="mobilYonlendir">Mobil Ekip</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive yonlendirme">
                                        <table id="example3" class="display table dataTable table-striped table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>Yönlendiren Kurum Türü</th>
                                                    <th>Yönlendiren Kurum</th>
                                                    <th>Yönlendirme Tarihi</th>
                                                    <th>Yönlendirilen Kurum Türü</th>
                                                    <th>Yönlendirilen Kurum</th>
                                                    <th>Yönlendirme Sonucu</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var r in randevular)
                                                {
                                                    <tr>
                                                        <td>@r.KaydedenKullaniciKurumTuru</td>
                                                        <td>@r.KaydedenKullaniciKurum</td>
                                                        <td>@r.RandevuBaslangicTarihi.ToString("dd/MM/yyyy HH:mm")</td>
                                                        <td>@r.PoliklinikAdi</td>
                                                        <td>@r.KurumAdi</td>
                                                        <td>@r.RandevuDurumu</td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @if (User.IsInRole("124"))
                    {
                        <div class="tab-pane" id="notlar" role="tabpanel">
                            <div class="card">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-8">
                                            <div class="table-responsive not">
                                                <table id="example4" class="display table dataTable table-striped table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Not Bilgisi</th>
                                                            <th>Kaydedilme Tarihi</th>
                                                            <th>Kaydeden Kişi</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (var n in notlar)
                                                        {
                                                            <tr>
                                                                <td>@n.NotBilgisi</td>
                                                                <td>@n.KayitTarihi.ToString("dd/MM/yyyy")</td>
                                                                <td>@n.KullaniciAdi</td>
                                                            </tr>
                                                        }
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        @if (User.IsInRole("74"))
                                        {
                                            <div class="col-md-4">
                                                <form>
                                                    <div class="form-group mb-0">
                                                        <textarea class="form-control height-200" placeholder="Not Bilgisi Giriniz." id="NotBilgisi" name="NotBilgisi"></textarea>
                                                        <ul class="list-inline mb-0 pt-3 bg-light p-3 border  border-top-0 d-flex justify-content-between align-items-center">
                                                            <li class="list-inline-item ml-auto"><button class="btn btn-primary btn-xs text-uppercase" id="notKaydet">Kaydet</button></li>
                                                        </ul>
                                                    </div>
                                                </form>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                    @if (User.IsInRole("125"))
                    {
                        <div class="tab-pane" id="formlar" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <div class="row">
                                        <div class="col-md-10">
                                            <h3 class="card-title">Formlar</h3>
                                        </div>
                                    </div>
                                </div>
                                <br />
                                <div class="card-content" style="margin-left:10px; margin-right:10px">
                                    <div class="row">
                                        @if (formlarim.Count() > 0)
                                        {
                                            foreach (var a in formlarim)
                                            {
                                                <div class="col-md-3">
                                                    <div class="card outline-badge-primary" style="margin-bottom:10px">
                                                        <div class="card-content">
                                                            <div class="card-body p-4">
                                                                <div class="d-md-flex">
                                                                    <div class="my-auto">
                                                                        <span class="icon-docs h3 text-primary"></span>
                                                                    </div>
                                                                    <div class="content px-md-3 my-3 my-md-0">
                                                                        <span class="mb-0 font-w-600 h5">@a.Baslik</span><br>
                                                                        <p class="mb-0 font-w-600 tx-                                     s-12">@string.Format("{0:dd.MM.yyyy}", a.BaslangicTarihi)</p>
                                                                        <p class="mb-0 font-w-500 tx-s-12">@a.Aciklama</p>
                                                                    </div>
                                                                    @if (User.IsInRole("75"))
                                                                    {
                                                                        <div class="my-auto">
                                                                            <a href="@Url.Action("FormDetay", "VakaTakip", new { id = a.ID, HastaID = Model.HastaID })" target="_blank" class="btn btn-outline-primary font-w-600 my-auto text-nowrap" id="formDetay">Detay</a>
                                                                        </div>
                                                                    }
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                        }
                                        else
                                        {
                                            <div class="card-content" style="margin-left:10px; margin-right:10px">
                                                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                                    <strong>Uyarı!</strong> Vakaya ait form bilgisi bulunmamaktadır.
                                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </div>
                                <br />
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $('#btnShow').click(function () {
        $('#YakinBilgileriModal').modal('show');
    })
    $('#btnIzlemEkle').click(function () {
        $('#IzlemBilgileriModal').modal('show');
    })
    $('#btnYakinBilgiKaydet').click(function () {

        if ($('#YakinAdi').val().trim() == "") {
            alert('Lütfen Yakın Adı Giriniz.');
            return;
        }
        if ($('#YakinSoyadi').val().trim() == "") {
            alert('Lütfen Yakın Soyadı Giriniz.');
            return;
        }
        if ($('#YakinTelefon').val().trim() == "") {
            alert('Lütfen Yakın Telefonu Giriniz.');
            return;
        }
        if ($('#YakinlikDerecesi').val().trim() == "") {
            alert('Lütfen Yakınlık Derecesi Giriniz.');
            return;
        }
        var data = {
            HastaID: parseInt(@Model.HastaID),
            YakinAdi: $('#YakinAdi').val().trim(),
            YakinSoyadi: $('#YakinSoyadi').val().trim(),
            YakinlikDerecesi: $('#YakinlikDerecesi').val(),
            Telefon: $('#YakinTelefon').val().trim(),
            Adres: $('#YakinAdres').val().trim()
        }

        $.ajax({
            type: "POST",
            url: '@Url.Action("HastaYakinBilgileriEkle", "VakaTakip")',
            data: data,
            success: function (data) {
                location.reload();
                $('#YakinBilgileriModal').modal('hide');
            },
            error: function () {
                alert('Kayıt sırasında hata oluştu. Lütfen tekrar deneyiniz.');
            }
        })
    })
    $('#btnIzlemKaydet').click(function () {

        if ($('#IzlemBasligi').val().trim() == "") {
            alert('Lütfen İzlem Başlığı Giriniz.');
            return;
        }
        if ($('#IzlemAciklama').val().trim() == "") {
            alert('Lütfen İzlem Açıklaması Giriniz.');
            return;
        }
        if ($('#IzlemYapanKurumTuru').val().trim() == "") {
            alert('Lütfen İzlem Yapan Kurum Türü Giriniz.');
            return;
        }
        if ($('#IzlemYapanKurum').val().trim() == "") {
            alert('Lütfen İzlem Yapan Kurum Giriniz.');
            return;
        }
        if ($('#IzlemVakaKaynagi').val().trim() == "") {
            alert('Lütfen İzlem Vaka Kaynağı Giriniz.');
            return;
        }
        if ($('#EldeEdilenBilgiler2').val().trim() == "") {
            alert('Lütfen Elde Edilen Bilgiler Giriniz.');
            return;
        }
        if ($('#IzlemSonucu').val().trim() == "") {
            alert('Lütfen İzlem Sonucu Giriniz.');
            return;
        }
        var data = {
            HastaID: parseInt(@Model.HastaID),
            IzlemYapanKurumTuru: $('#IzlemYapanKurumTuru').val().trim(),
            IzlemYapanKurum: $('#IzlemYapanKurum').val().trim(),
            IzlemVakaKaynagi: $('#IzlemVakaKaynagi').val().trim(),
            EldeEdilenBilgiler: $('#EldeEdilenBilgiler2').val().trim(),
            IzlemSonucu: $('#IzlemSonucu').val().trim(),
            IzlemBasligi: $('#IzlemBasligi').val().trim(),
            IzlemAciklama: $('#IzlemAciklama').val().trim(),
        }

        $.ajax({
            type: "POST",
            url: '@Url.Action("HastaIzlemBilgisiEkle", "VakaTakip")',
            data: data,
            success: function (data) {
                location.reload();
                $('#IzlemBilgileriModal').modal('hide');
            },
            error: function () {
                alert('Kayıt sırasında hata oluştu. Lütfen tekrar deneyiniz.');
            }
        })
    })
    $('#notKaydet').click(function () {

        var data = {
            HastaID: parseInt(@Model.HastaID),
            NotBilgisi: $('#NotBilgisi').val().trim()
        }

        $.ajax({
            type: "POST",
            url: '@Url.Action("HastaNotBilgisiEkle", "VakaTakip")',
            data: data,
            success: function (data) {
                location.reload();
            },
            error: function () {
                alert('Kayıt sırasında hata oluştu. Lütfen tekrar deneyiniz.');
            }
        })
    })
</script>
<script>
    $('#arindirmaYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("Kurumlar", "ArindirmaMerkezleri")?HastaID=' + hId;
    })
    $('#rehabilitasyonYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("Kurumlar", "ArindirmaMerkezleri")?HastaID=' + hId;
    })
    $('#yedamYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("YEDAMRandevuTalebiOlustur", "KurumlarArasiSevkVeTakip")?HastaID=' + hId;
    })
    $('#sosyalHizmetYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("SHMRandevuTalebiOlustur", "KurumlarArasiSevkVeTakip")?HastaID=' + hId;
    })
    $('#iskurYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("IskurRandevuTalebiOlustur", "KurumlarArasiSevkVeTakip")?HastaID=' + hId;
    })
    $('#ilceSaglikYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("ISMRandevuTalebiOlustur", "KurumlarArasiSevkVeTakip")?HastaID=' + hId;
    })
    $('#iskurYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("IskurRandevuTalebiOlustur", "KurumlarArasiSevkVeTakip")?HastaID=' + hId;
    })
    $('#mobilYonlendir').click(function () {
        var hId = @Model.HastaID;
        window.location = '@Url.Action("MobilEkipRandevuTalebiOlustur", "KurumlarArasiSevkVeTakip")?HastaID=' + hId;
    })
</script>
<script>
    $(document).ready(function () {
        $(".timeline").slice(0, 1).show();
        if ($(".timeline-item:hidden").length != 0) {
            $("#loadMore").show();
        }
        $("#loadMore").on('click', function (e) {
            e.preventDefault();
            $(".timeline-item:hidden").slice(0, 1).slideDown();
            if ($(".timeline-item:hidden").length == 0) {
                $("#loadMore").fadeOut('slow');
            }
        });
    });
    //Infinite Scroll
    $(window).on("scroll", function () {
        //page height
        var scrollHeight = $(document).height();
        //scroll position
        var scrollPos = $(window).height() + $(window).scrollTop();
        // fire if the scroll position is 300 pixels above the bottom of the page
        if (((scrollHeight - 100) >= scrollPos) / scrollHeight == 0) {
            $('#loadMore').click();
        }
    });
</script>
<script>
    var tel = document.getElementsByClassName("tel");
    $('.tel').mask('0(000) 000 00 00');
</script>

<style>
    textarea {
        max-height: 70px;
        min-height: 50px;
    }
</style>

<script src="~/dist/vendors/jquery/jquery-3.3.1.min.js"></script>
<script src="~/dist/vendors/jquery-ui/jquery-ui.min.js"></script>
<script src="~/dist/vendors/moment/moment.js"></script>
<script src="~/dist/vendors/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="~/dist/vendors/slimscroll/jquery.slimscroll.min.js"></script>
<script src="~/dist/vendors/datatable/js/jquery.dataTables.min.js"></script>
<script src="~/dist/vendors/datatable/js/dataTables.bootstrap4.min.js"></script>
<script src="~/dist/vendors/datatable/jszip/jszip.min.js"></script>
<script src="~/dist/vendors/datatable/pdfmake/pdfmake.min.js"></script>
<script src="~/dist/vendors/datatable/pdfmake/vfs_fonts.js"></script>
<script src="~/dist/vendors/datatable/buttons/js/dataTables.buttons.min.js"></script>
<script src="~/dist/vendors/datatable/buttons/js/buttons.bootstrap4.min.js"></script>
<script src="~/dist/vendors/datatable/buttons/js/buttons.colVis.min.js"></script>
<script src="~/dist/vendors/datatable/buttons/js/buttons.flash.min.js"></script>
<script src="~/dist/vendors/datatable/buttons/js/buttons.html5.min.js"></script>
<script src="~/dist/vendors/datatable/buttons/js/buttons.print.min.js"></script>
<script src="~/dist/js/app.js"></script>
<script src="~/Content/DataTablesScript.js"></script>

<script src="~/dist/vendors/jquery/jquery-3.3.1.min.js"></script>
<script src="~/dist/vendors/jquery-ui/jquery-ui.min.js"></script>
<script src="~/dist/vendors/moment/moment.js"></script>
<script src="~/dist/vendors/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="~/dist/vendors/slimscroll/jquery.slimscroll.min.js"></script>
<script src="~/dist/js/app.js"></script>